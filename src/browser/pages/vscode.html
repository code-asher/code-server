<!-- Copyright (C) Microsoft Corporation. All rights reserved. -->
<!DOCTYPE html>
<html>
  <head>
    <script>
      performance.mark("code/didStartRenderer")
    </script>

    <meta charset="utf-8" />

    <!-- Disable pinch zooming -->
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"
    />

    <!-- Workbench Configuration -->
    <meta id="vscode-workbench-web-configuration" data-settings="{{WORKBENCH_WEB_CONFIGURATION}}" />

    <!-- Workarounds/Hacks (remote user data uri) -->
    <meta id="vscode-remote-user-data-uri" data-settings="{{REMOTE_USER_DATA_URI}}" />
    <meta id="vscode-remote-product-configuration" data-settings="{{PRODUCT_CONFIGURATION}}" />
    <meta id="vscode-remote-nls-configuration" data-settings="{{NLS_CONFIGURATION}}" />

    <!-- Workbench Icon/Manifest/CSS -->
    <link rel="icon" href="{{CS_STATIC_BASE}}/src/browser/media/favicon-dark-support.svg" />
    <link rel="alternate icon" href="{{CS_STATIC_BASE}}/src/browser/media/favicon.ico" />
    <link rel="manifest" href="{{CS_STATIC_BASE}}/src/browser/media/manifest.json" crossorigin="use-credentials" />
    <!-- PROD_ONLY
    <link data-name="vs/workbench/workbench.web.api" rel="stylesheet" href="{{CS_STATIC_BASE}}/lib/vscode/out/vs/workbench/workbench.web.api.css">
    END_PROD_ONLY -->
    <link rel="apple-touch-icon" sizes="192x192" href="{{CS_STATIC_BASE}}/src/browser/media/pwa-icon-192.png" />
    <link rel="apple-touch-icon" sizes="512x512" href="{{CS_STATIC_BASE}}/src/browser/media/pwa-icon-512.png" />
    <meta name="apple-mobile-web-app-capable" content="yes" />

    <meta id="coder-options" data-settings="{{OPTIONS}}" />
  </head>

  <body aria-label=""></body>

  <!-- Startup (do not modify order of script tags!) -->
  <script>
    const normalize = (url, keepTrailing = false) => {
      return url.replace(/\/\/+/g, "/").replace(/\/+$/, keepTrailing ? "/" : "")
    }

    const resolveBase = (base) => {
      // After resolving the base will either start with / or be an empty string.
      if (!base || base.startsWith("/")) {
        return base ?? ""
      }
      const parts = location.pathname.split("/")
      parts[parts.length - 1] = base
      const url = new URL(location.origin + "/" + parts.join("/"))
      return normalize(url.pathname)
    }

    const base = resolveBase("{{CS_STATIC_BASE}}")
    console.log(base)

    self.require = {
      // Without the full URL VS Code will try to load file://.
      baseUrl: `${window.location.origin}${base}/lib/vscode/out`,
      recordStats: true,
      paths: {
        "vscode-textmate": `../node_modules/vscode-textmate/release/main`,
        "vscode-oniguruma": `../node_modules/vscode-oniguruma/release/main`,
        xterm: `../node_modules/xterm/lib/xterm.js`,
        "xterm-addon-search": `../node_modules/xterm-addon-search/lib/xterm-addon-search.js`,
        "xterm-addon-unicode11": `../node_modules/xterm-addon-unicode11/lib/xterm-addon-unicode11.js`,
        "xterm-addon-webgl": `../node_modules/xterm-addon-webgl/lib/xterm-addon-webgl.js`,
        "tas-client-umd": `../node_modules/tas-client-umd/lib/tas-client-umd.js`,
        "iconv-lite-umd": `../node_modules/iconv-lite-umd/lib/iconv-lite-umd.js`,
        jschardet: `../node_modules/jschardet/dist/jschardet.min.js`,
      },
    }
  </script>
  <!-- <script data-cfasync="false" type="module" src="{{CS_STATIC_BASE}}/out/browser/pages/vscode.browserified.js"></script> -->
  <script data-cfasync="false" type="module" src="{{CS_STATIC_BASE}}/out/browser/register.browserified.js"></script>
  <script data-cfasync="false" src="{{CS_STATIC_BASE}}/lib/vscode/out/vs/loader.js"></script>
  <script>
    performance.mark("code/willLoadWorkbenchMain")
  </script>
  <!-- PROD_ONLY
  <script data-cfasync="false" src="{{CS_STATIC_BASE}}/lib/vscode/out/vs/workbench/workbench.web.api.nls.js"></script>
  <script data-cfasync="false" src="{{CS_STATIC_BASE}}/lib/vscode/out/vs/workbench/workbench.web.api.js"></script>
  END_PROD_ONLY -->
  <script>
    require(["vs/code/browser/workbench/workbench"], function () {})
  </script>
</html>
